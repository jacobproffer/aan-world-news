{{ define "main" -}}

<div class="post gray-background">
  <div class="container container--wide container--white">
    <div class="post__container grid">

      <aside class="post__aside">
        {{ if .Params.asideText }}
          <figure>
            <img src="{{ .Params.asidePhoto }}" alt="{{ .Params.asideText }}" />
            <figcaption>
              <p>{{ .Params.asideText }}</p>
            </figcaption>
          </figure>
        {{ end }}
      </aside>

      <article class="content">

        <header class="post__header padding">

          {{ if isset .Params "title" }}
            <h1>{{ .Title }}</h1>
          {{ end }}

          {{ if isset .Params "author" }}
            <span class="post__author h4">
              by <a class="red" href="{{ .Params.profileURL }}">{{ .Params.author }}</a>
            </span>
          {{ end }}

          <time class="h4" datetime="{{ .PublishDate.Format "2006-01-02" }}">
            {{ .PublishDate.Format "2006-01-02 400 EDT" }}
          </time>

        </header>

        {{ if isset .Params "description" }}
          <p class="post__description h4 padding">{{ .Params.description }}</p>
        {{ end }}

        {{ .Content }}

        {{ range .Params.profiles }}

          {{ with $.Site.GetPage "taxonomyTerm" (printf "profiles/%s" (urlize .)) }}
            <footer class="post__footer grid">
              <img src="{{ .Params.photo }}" alt="Portrait of {{ .Params.name }}" />
              <p>{{ .Params.bio }}</p>
            </footer>
          {{ end }}

        {{ end }}

      </article>

      {{ $related := .Site.RegularPages.Related . | first 3 }}

      {{ with $related }}

        <div class="post__related">

          <header>
            <h2 id="related-posts">Related Posts</h2>
          </header>

          <ul aria-labelledby="related-posts">
            {{ range . }}
              <li>
                {{ .Render "card" }}
              </li>
            {{ end }}
          </ul>

        </div>

      {{ end }}

    </div>
  </div>
</div>

{{ partial "seo/single-schema.html" . }}

{{- end }}
